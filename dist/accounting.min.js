!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):r.accounting=e()}(this,function(){"use strict";var r={version:"0.4.2",settings:{currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}}},e=Array.prototype.map,n=Array.isArray,t=Object.prototype.toString;function o(r){return!!(""===r||r&&r.charCodeAt&&r.substr)}function a(r){return n?n(r):"[object Array]"===t.call(r)}function i(r){return r&&"[object Object]"===t.call(r)}function u(r,e){var n;for(n in r=r||{},e=e||{})e.hasOwnProperty(n)&&null==r[n]&&(r[n]=e[n]);return r}function s(r,n,t){var o,a,i=[];if(!r)return i;if(e&&r.map===e)return r.map(n,t);for(o=0,a=r.length;o<a;o++)i[o]=n.call(t,r[o],o,r);return i}function c(r,e){return r=Math.round(Math.abs(r)),isNaN(r)?e:r}function f(e){var n=r.settings.currency.format;return"function"==typeof e&&(e=e()),o(e)&&e.match("%v")?{pos:e,neg:e.replace("-","").replace("%v","-%v"),zero:e}:e&&e.pos&&e.pos.match("%v")?e:o(n)?r.settings.currency.format={pos:n,neg:n.replace("%v","-%v"),zero:n}:n}var p=r.unformat=r.parse=function(e,n){if(a(e))return s(e,function(r){return p(r,n)});if("number"==typeof(e=e||0))return e;n=n||r.settings.number.decimal;var t=new RegExp("[^0-9-"+n+"]",["g"]),o=parseFloat((""+e).replace(/\((?=\d+)(.*)\)/,"-$1").replace(t,"").replace(n,"."));return isNaN(o)?0:o},l=r.toFixed=function(e,n){n=c(n,r.settings.number.precision);var t=Number(r.unformat(e)+"e"+n),o=Math.round(t);return Number(o+"e-"+n).toFixed(n)},m=r.formatNumber=r.format=function(e,n,t,o){if(a(e))return s(e,function(r){return m(r,n,t,o)});e=p(e);var f=u(i(n)?n:{precision:n,thousand:t,decimal:o},r.settings.number),d=c(f.precision),g=e<0?"-":"",h=parseInt(l(Math.abs(e||0),d),10)+"",b=h.length>3?h.length%3:0;return g+(b?h.substr(0,b)+f.thousand:"")+h.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+f.thousand)+(d?f.decimal+l(Math.abs(e),d).split(".")[1]:"")},d=r.formatMoney=function(e,n,t,o,l,g){if(a(e))return s(e,function(r){return d(r,n,t,o,l,g)});e=p(e);var h=u(i(n)?n:{symbol:n,precision:t,thousand:o,decimal:l,format:g},r.settings.currency),b=f(h.format);return(e>0?b.pos:e<0?b.neg:b.zero).replace("%s",h.symbol).replace("%v",m(Math.abs(e),c(h.precision),h.thousand,h.decimal))};return r.formatColumn=function(e,n,t,l,d,g){if(!e||!a(e))return[];var h=u(i(n)?n:{symbol:n,precision:t,thousand:l,decimal:d,format:g},r.settings.currency),b=f(h.format),y=b.pos.indexOf("%s")<b.pos.indexOf("%v"),v=0;return s(s(e,function(e){if(a(e))return r.formatColumn(e,h);var n=((e=p(e))>0?b.pos:e<0?b.neg:b.zero).replace("%s",h.symbol).replace("%v",m(Math.abs(e),c(h.precision),h.thousand,h.decimal));return n.length>v&&(v=n.length),n}),function(r){return o(r)&&r.length<v?y?r.replace(h.symbol,h.symbol+new Array(v-r.length+1).join(" ")):new Array(v-r.length+1).join(" ")+r:r})},r});
